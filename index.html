<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Predica PRO</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3E‚úùÔ∏è%3C/text%3E%3C/svg%3E">
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#3f51b5">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Predicaciones">
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3E‚úùÔ∏è%3C/text%3E%3C/svg%3E">
    <!-- Manifest -->
    <link rel="manifest" href="manifest.json">
    <!-- Incluimos las librer√≠as necesarias -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <!-- Overlay para tutorial -->
    <div id="tutorial-overlay" class="tutorial-overlay" style="display: none;">
        <div class="tutorial-content">
            <div class="tutorial-header">
                <h3 id="tutorial-title">üéì Tutorial - Paso 1</h3>
                <button id="tutorial-close" class="close-button">‚úñÔ∏è</button>
            </div>
            <div class="tutorial-body">
                <p id="tutorial-text">Bienvenido a Predica PRO. Este tutorial te guiar√° paso a paso.</p>
                <div class="tutorial-highlight"></div>
            </div>
            <div class="tutorial-footer">
                <button id="tutorial-prev" class="tutorial-button">‚¨ÖÔ∏è Anterior</button>
                <span id="tutorial-progress">1 / 6</span>
                <button id="tutorial-next" class="tutorial-button">Siguiente ‚û°Ô∏è</button>
                <button id="tutorial-skip" class="tutorial-button secondary">Saltar Tutorial</button>
            </div>
        </div>
    </div>

    <!-- Zona de drag and drop -->
    <div id="drop-zone" class="drop-zone" style="display: none;">
        <div class="drop-zone-content">
            <div class="drop-icon">üìÅ</div>
            <p>Suelta aqu√≠ tu archivo para importarlo</p>
            <small>Archivos soportados: .json, .txt, .docx</small>
        </div>
    </div>

    <!-- Sistema de notificaciones mejorado -->
    <div id="notification-container" class="notification-container"></div>

    <!-- Indicador de atajos de teclado -->
    <div id="keyboard-shortcuts-help" class="keyboard-help" style="display: none;">
        <div class="keyboard-help-content">
            <h3>‚å®Ô∏è Atajos de Teclado</h3>
            <div class="shortcuts-list">
                <div class="shortcut-item">
                    <kbd>Ctrl</kbd> + <kbd>S</kbd>
                    <span>Guardar serm√≥n</span>
                </div>
                <div class="shortcut-item">
                    <kbd>Ctrl</kbd> + <kbd>O</kbd>
                    <span>Abrir serm√≥n</span>
                </div>
                <div class="shortcut-item">
                    <kbd>Ctrl</kbd> + <kbd>P</kbd>
                    <span>Generar PDF</span>
                </div>
                <div class="shortcut-item">
                    <kbd>Ctrl</kbd> + <kbd>N</kbd>
                    <span>Nuevo serm√≥n</span>
                </div>
                <div class="shortcut-item">
                    <kbd>Ctrl</kbd> + <kbd>D</kbd>
                    <span>Alternar modo oscuro</span>
                </div>
                <div class="shortcut-item">
                    <kbd>F1</kbd>
                    <span>Mostrar tutorial</span>
                </div>
                <div class="shortcut-item">
                    <kbd>Esc</kbd>
                    <span>Cerrar modales</span>
                </div>
            </div>
            <button id="close-shortcuts-help" class="close-button">‚úñÔ∏è</button>
        </div>
    </div>

    <header>
        <h1>Predica PRO</h1>
        <p>Crea, personaliza y descarga tu predicaci√≥n en formato PDF</p>
        <!-- Controles del header -->
        <div class="header-controls">
            <button id="dark-mode-toggle" class="header-button" title="Alternar modo oscuro (Ctrl+D)">üåô</button>
            <button id="tutorial-start" class="header-button" title="Iniciar tutorial (F1)">üéì</button>
            <button id="shortcuts-help" class="header-button" title="Atajos de teclado (?)">‚å®Ô∏è</button>
            <button id="install-btn" class="install-button" style="display: block;">üì± Instalar App</button>
        </div>
    </header>

    <main>
        <div class="container">
            <div class="editor-container">
                <div class="editor-controls">
                    <h2>Editor de Predicaci√≥n</h2>
                    
                    <!-- Panel de herramientas expandido -->
                    <div class="toolbar">
                        <!-- Gesti√≥n de Sermones -->
                        <div class="toolbar-section">
                            <h3>üìö Gesti√≥n de Sermones</h3>
                            <div class="sermon-management">
                                <button type="button" id="new-sermon-btn" class="action-button" title="Nuevo serm√≥n (Ctrl+N)">üìÑ Nuevo Serm√≥n</button>
                                <select title="seleccion de sermon" id="sermon-list">
                                    <option value="">-- Seleccionar serm√≥n --</option>
                                </select>
                                <button type="button" id="delete-sermon-btn" class="action-button delete-btn">üóëÔ∏è Eliminar</button>
                            </div>
                        </div>

                        <!-- Plantillas -->
                        <div class="toolbar-section">
                            <h3>üìÑ Plantillas</h3>
                            <div class="control-group">
                                <label for="template-select">Seleccionar plantilla:</label>
                                <select id="template-select">
                                    <option value="">-- Seleccionar plantilla --</option>
                                    <option value="evangelistic">Evangel√≠stica</option>
                                    <option value="teaching">Ense√±anza</option>
                                    <option value="devotional">Devocional</option>
                                </select>
                            </div>
                        </div>

                        <!-- Guardado y Exportaci√≥n -->
                        <div class="toolbar-section">
                            <h3>üíæ Guardado y Exportaci√≥n</h3>
                            <div class="save-controls">
                                <button type="button" id="save-btn" class="save-button" title="Guardar (Ctrl+S)">üíæ Guardar</button>
                                <button type="button" id="load-btn" class="load-button" title="Cargar (Ctrl+O)">üìÇ Cargar</button>
                                <button type="button" id="import-btn" class="import-button">üì• Importar</button>
                                <span id="save-status" class="save-status">‚úÖ Guardado</span>
                            </div>
                            <div class="export-controls">
                                <button type="button" id="export-txt-btn" class="export-button">üìù Exportar TXT</button>
                                <button type="button" id="export-html-btn" class="export-button">üåê Exportar HTML</button>
                                <button type="button" id="export-docx-btn" class="export-button">üìÑ Exportar DOCX</button>
                            </div>
                        </div>

                        <!-- B√∫squeda B√≠blica -->
                        <div class="toolbar-section">
                            <h3>üìñ B√∫squeda B√≠blica</h3>
                            <div class="bible-search">
                                <input type="text" id="bible-search-input" placeholder="Buscar vers√≠culo (ej: Juan 3:16)">
                                <button type="button" id="bible-search-btn" class="search-button">üîç Buscar</button>
                            </div>
                        </div>

                        <!-- Temporizador -->
                        <div class="toolbar-section">
                            <h3>‚è±Ô∏è Temporizador de Serm√≥n</h3>
                            <div class="timer-controls">
                                <div class="timer-display" id="timer-display">00:00</div>
                                <div class="timer-buttons">
                                    <button type="button" id="timer-toggle" class="timer-button">‚ñ∂Ô∏è Iniciar</button>
                                    <button type="button" id="timer-reset" class="timer-button">üîÑ Reiniciar</button>
                                </div>
                                <div class="timer-settings">
                                    <label for="target-time">Tiempo objetivo (minutos):</label>
                                    <input type="number" id="target-time" min="1" max="120" value="30">
                                </div>
                            </div>
                        </div>

                        <!-- Estad√≠sticas -->
                        <div class="toolbar-section">
                            <h3>üìä Estad√≠sticas</h3>
                            <div class="word-count-summary">
                                <span id="total-words">Palabras totales: 0</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Controles de estilo -->
                    <div class="style-controls">
                        <h3>üé® Personalizaci√≥n</h3>
                        <div class="control-group">
                            <label for="font-family">Fuente:</label>
                            <select id="font-family">
                                <option value="Arial, sans-serif">Arial</option>
                                <option value="Times New Roman, serif">Times New Roman</option>
                                <option value="Calibri, sans-serif">Calibri</option>
                                <option value="Georgia, serif">Georgia</option>
                                <option value="Verdana, sans-serif">Verdana</option>
                                <option value="Trebuchet MS, sans-serif">Trebuchet MS</option>
                            </select>
                        </div>

                        <div class="control-group">
                            <label for="font-size">Tama√±o de fuente:</label>
                            <select id="font-size">
                                <option value="12px">Peque√±o (12px)</option>
                                <option value="14px">Normal (14px)</option>
                                <option value="16px" selected>Mediano (16px)</option>
                                <option value="18px">Grande (18px)</option>
                                <option value="20px">Muy Grande (20px)</option>
                            </select>
                        </div>

                        <div class="control-group">
                            <label for="theme">Tema:</label>
                            <select id="theme">
                                <option value="light">Claro</option>
                                <option value="dark">Oscuro</option>
                                <option value="sepia">Sepia</option>
                                <option value="blue">Azul</option>
                                <option value="green">Verde</option>
                            </select>
                        </div>

                        <div class="control-group">
                            <label for="text-color">Color del texto:</label>
                            <input type="color" id="text-color" value="#333333">
                        </div>

                        <div class="control-group">
                            <label for="background-color">Color de fondo:</label>
                            <input type="color" id="background-color" value="#ffffff">
                        </div>

                        <div class="control-group">
                            <label for="line-height">Espaciado de l√≠neas:</label>
                            <select id="line-height">
                                <option value="1.2">Compacto (1.2)</option>
                                <option value="1.4">Normal (1.4)</option>
                                <option value="1.6" selected>C√≥modo (1.6)</option>
                                <option value="1.8">Amplio (1.8)</option>
                                <option value="2.0">Muy Amplio (2.0)</option>
                            </select>
                        </div>
                    </div>

                    <form id="sermon-form">
                        <div class="form-group">
                            <label for="sermon-theme">Tema:</label>
                            <input type="text" id="sermon-theme" placeholder="Ej: El amor de Dios" required>
                            <span class="word-count" id="theme-count">0 palabras</span>
                        </div>

                        <div class="form-group">
                            <label for="sermon-text">Texto B√≠blico:</label>
                            <input type="text" id="sermon-text" placeholder="Ej: Juan 3:16" required>
                            <span class="word-count" id="text-count">0 palabras</span>
                        </div>

                        <div class="form-group">
                            <label for="sermon-title">T√≠tulo:</label>
                            <input type="text" id="sermon-title" placeholder="Ej: El amor incondicional de Dios" required>
                            <span class="word-count" id="title-count">0 palabras</span>
                        </div>

                        <div class="form-group">
                            <label for="sermon-purpose">Prop√≥sito:</label>
                            <textarea id="sermon-purpose" placeholder="Ej: Mostrar el amor incondicional de Dios hacia la humanidad" required></textarea>
                            <span class="word-count" id="purpose-count">0 palabras</span>
                        </div>

                        <div class="form-group">
                            <label for="sermon-intro">Introducci√≥n:</label>
                            <textarea id="sermon-intro" placeholder="Escribe la introducci√≥n de tu predicaci√≥n..." required></textarea>
                            <span class="word-count" id="intro-count">0 palabras</span>
                        </div>

                        <div class="form-group">
                            <label for="sermon-body">Cuerpo de la Predicaci√≥n:</label>
                            <textarea id="sermon-body" placeholder="Desarrolla los puntos principales de tu predicaci√≥n..." required></textarea>
                            <span class="word-count" id="body-count">0 palabras</span>
                        </div>

                        <div class="form-group">
                            <label for="sermon-conclusion">Conclusi√≥n:</label>
                            <textarea id="sermon-conclusion" placeholder="Escribe la conclusi√≥n de tu predicaci√≥n..." required></textarea>
                            <span class="word-count" id="conclusion-count">0 palabras</span>
                        </div>

                        <div class="form-actions">
                            <button type="button" id="preview-btn">üëÅÔ∏è Vista Previa</button>
                            <button type="button" id="generate-pdf-btn" title="Generar PDF (Ctrl+P)">üìÑ Generar PDF</button>
                            <button type="button" id="reset-styles-btn">üîÑ Restablecer Estilos</button>
                        </div>
                    </form>
                </div>
            </div>

            <div class="preview-container" id="preview-container">
                <h2>Vista Previa</h2>
                <div class="sermon-preview" id="sermon-preview">
                    <div class="sermon-header">
                        <h1 id="preview-title">T√≠tulo de la Predicaci√≥n</h1>
                        <p id="preview-theme">Tema: </p>
                        <p id="preview-text">Texto B√≠blico: </p>
                    </div>
                    <div class="sermon-content">
                        <div class="sermon-section">
                            <h3>Prop√≥sito</h3>
                            <p id="preview-purpose"></p>
                        </div>
                        <div class="sermon-section">
                            <h3>Introducci√≥n</h3>
                            <p id="preview-intro"></p>
                        </div>
                        <div class="sermon-section">
                            <h3>Desarrollo</h3>
                            <p id="preview-body"></p>
                        </div>
                        <div class="sermon-section">
                            <h3>Conclusi√≥n</h3>
                            <p id="preview-conclusion"></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Modal para b√∫squeda b√≠blica -->
    <div id="bible-search-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üìñ Resultados de B√∫squeda B√≠blica</h3>
                <button type="button" id="close-bible-modal" class="close-button">‚úñÔ∏è</button>
            </div>
            <div class="modal-body">
                <div id="bible-search-results"></div>
            </div>
        </div>
    </div>

    <footer>
        <p>&copy; 2023 Predica PRO - Creador de Predicaciones Cristianas</p>
    </footer>

    <script src="script.js"></script>
    <script src="pdf-generator.js"></script>
    <script src="pwa.js"></script>
</body>
</html>